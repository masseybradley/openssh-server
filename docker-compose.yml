version: '3.7'
services:
  openssh:
    image: 'openssh-server'
    container_name: 'openssh'
    hostname: 'openssh'
    domainname: 'lazybit.ch'
    restart: 'always'
    depends_on:
    - 'rsyslog'
    volumes:
    - '${HOME}/.ssh/id_rsa.pub:/home/ubuntu/.ssh/authorized_keys:ro'
    - 'openssh:/etc/ssh'
    - './etc/ssh/sshd_config:/etc/ssh/sshd_config:ro'
    - './etc/ssh/ssh_config:/etc/ssh/ssh_config:ro'
    - 'rsyslog:/var/run/rsyslog/dev'
    cap_add:
    - 'SYS_CHROOT'
    - 'SETGID'
    - 'SETUID'
    - 'CHOWN'
    ports:
    - '22:22'
  rsyslog:
    image: 'rsyslog'
    container_name: 'rsyslog'
    restart: 'always'
    volumes:
    - './etc/rsyslog.conf:/etc/rsyslog.conf:ro'
    - './etc/rsyslog.d/60-output.conf:/etc/rsyslog.d/60-output.conf:ro'
    - 'rsyslog:/var/run/rsyslog/dev'
    cap_add:
    - 'NET_BIND_SERVICE'
volumes:
  openssh:
  rsyslog:
